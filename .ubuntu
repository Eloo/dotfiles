# Ubuntu specific dotfile for zsh

#
# Antigen bundles
#
antigen bundle ubuntu

# default aliases
alias editubuntu='nano ~/dotfiles/.ubuntu && source ~/dotfiles/.ubuntu'

## Apt aliases

#alias aptinst='sudo apt-get install'
#alias aptupdate='sudo apt-get update'
#alias aptupgrade='sudo apt-get upgrade'
#alias aptdistupgrade='sudo apt-get dist-upgrade'
#alias aptremove='sudo apt-get remove'


#
# Ubuntu functions
#

function apt-history(){

      case "$1" in
        install)
              grep 'install ' /var/log/dpkg.log
              ;;
        upgrade|remove)
              grep $1 /var/log/dpkg.log
              ;;
        rollback)
              grep upgrade /var/log/dpkg.log | \
                  grep "$2" -A10000000 | \
                  grep "$3" -B10000000 | \
                  awk '{print $4"="$5}'
              ;;
        *)
              cat /var/log/dpkg.log
              ;;
      esac
}

function apt-install-history(){
	comm -23 <(find /var/log/apt/ -name "history.*" -exec zsh -c "zgrep 'apt-get install' {}" \; | sed 's/.* //' | sort) <(find /var/log/apt/ -name "history.*" -exec zsh -c "zgrep 'apt-get remove' {}" \; | sed 's/.* //' | sort)
}