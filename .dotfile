#
# This is the main dotfiles which will source all other dotfiles.
# Only this file must be sourced in your ~/.zshrc
#

# Update dotfiles
# Check return value to see if there are incoming updates.
(cd ~/dotfiles;
if [ `git rev-list origin/master..HEAD | wc -l` -gt 0 ]; then
	git pull
fi
)

# Load 256 color
export TERM="xterm-256color"

# Load Antigen
POWERLEVEL9K_MODE='awesome-patched'
[ ! -f ~/dotfiles/antigen.zsh ] && wget 'https://raw.githubusercontent.com/zsh-users/antigen/master/bin/antigen.zsh' -O ~/dotfiles/antigen.zsh
# source $HOME/dotfiles/antigen.zsh
# if ! type antigen > /dev/null; then
# 	echo "antigen not found"
# 	source $HOME/dotfiles/antigen.zsh
# fi
# [ -r "~/dotfiles/.antigen" ] && source "~/dotfiles/.antigen"

# Zplug
source ~/.zplug/init.zsh
source "$HOME/dotfiles/.zplug"


# Load our dotfiles like ~/.antigen, etc…
#   ~/dotfiles/.extra and ~/dotfiles/.local can be used for settings you don’t want to commit,
#   Use it to configure your PATH, thus it being first in line.
for file in ~/dotfiles/.{extra,local,exports,aliases,functions}; do
    [ -r "$file" ] && source "$file"
done
unset file

# Get OS name
CURRENT_OS=`uname`

# OS specific plugins
if [[ $CURRENT_OS == 'Darwin' ]]; then

    [ -f ~/dotfiles/.osx ] && source ~/dotfiles/.osx

elif [[ $CURRENT_OS == 'Linux' ]]; then
	DISTRO=`cat /etc/*-release | grep ^ID=`
    # Load ubuntu specific stuff (and for debian as there isn't much atm)
    if [[ $DISTRO == *'ubuntu'* || $DISTRO == *'debian'* ]]; then
        [ -f ~/dotfiles/.ubuntu ] && source ~/dotfiles/.ubuntu
    fi
fi
